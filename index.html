<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <title>Work Day Scheduler</title>
</head>

<body>
    <header class="jumbotron">
        <h1 class="display-3">Work Day Scheduler</h1>
        <p class="description">A simple calendar app for scheduling your work day</p>
        <p id="currentDay" class="lead"></p>
    </header>
    <div class="container">
        <!-- Timeblocks go here -->
        <!-- html help from https://stackoverflow.com/questions/59995703/trying-to-change-background-color-based-off-if-the-hour-is-in-the-past-current-->
        <div class="time-block">
            <div class="row">
                <div class="col-2 hour"> 8am
                </div>
                <div id="8Div" class="col-8 scheduler" data-value=8>
                    <input id="8amInput" class="textarea bg-transparent" type="text" placeholder="Add event">
                </div>
                <div class="col-2 save">
                    <button type="button" id="8amBtn" class="btn btn-primary saveBtn">Save</button>
                </div>
            </div>
        </div>

        <div class="time-block">
            <div class="row">
                <div class="col-2 hour"> 9am
                </div>
                <div id="9Div" class="col-8 scheduler" data-value=9>
                    <input id="9amInput" class="textarea bg-transparent" type="text" placeholder="Add event">
                </div>
                <div class="col-2 save">
                    <button type="button" id="9amBtn" class="btn btn-primary saveBtn">Save</button>
                </div>
            </div>
        </div>

        <div class="time-block">
            <div class="row">
                <div class="col-2 hour"> 10am
                </div>
                <div id="10Div" class="col-8 scheduler" data-value=10>
                    <input id="10amInput" class="textarea bg-transparent" type="text" placeholder="Add event">
                </div>
                <div class="col-2 save">
                    <button type="button" id="10amBtn" class="btn btn-primary saveBtn">Save</button>
                </div>
            </div>
        </div>

        <div class="time-block">
            <div class="row">
                <div class="col-2 hour"> 11am
                </div>
                <div id="11Div" class="col-8 scheduler" data-value=11>
                    <input id="11amInput" class="textarea bg-transparent" type="text" placeholder="Add event">
                </div>
                <div class="col-2 save">
                    <button type="button" id="11amBtn" class="btn btn-primary saveBtn">Save</button>
                </div>
            </div>
        </div>

        <div class="time-block">
            <div class="row">
                <div class="col-2 hour"> 12pm
                </div>
                <div id="12Div" class="col-8 scheduler" data-value=12>
                    <input id="12pmInput" class="textarea bg-transparent" type="text" placeholder="Add event">
                </div>
                <div class="col-2 save">
                    <button type="button" id="12pmBtn" class="btn btn-primary saveBtn">Save</button>
                </div>
            </div>
        </div>

        <div class="time-block">
            <div class="row">
                <div class="col-2 hour"> 1pm
                </div>
                <div id="13Div" class="col-8 scheduler" data-value=13>
                    <input id="1pmInput" class="textarea bg-transparent" type="text" placeholder="Add event">
                </div>
                <div class="col-2 save">
                    <button type="button" id="1pmBtn" class="btn btn-primary saveBtn">Save</button>
                </div>
            </div>
        </div>

        <div class="time-block">
            <div class="row">
                <div class="col-2 hour"> 2pm
                </div>
                <div id="14Div" class="col-8 scheduler" data-value=14>
                    <input id="2pmInput" class="textarea bg-transparent" type="text" placeholder="Add event">
                </div>
                <div class="col-2 save">
                    <button type="button" id="2pmBtn" class="btn btn-primary saveBtn">Save</button>
                </div>
            </div>
        </div>

        <div class="time-block">
            <div class="row">
                <div class="col-2 hour"> 3pm
                </div>
                <div id="15Div" class="col-8 scheduler" data-value=15>
                    <input id="3pmInput" class="textarea bg-transparent" type="text" placeholder="Add event">
                </div>
                <div class="col-2 save">
                    <button type="button" id="3pmBtn" class="btn btn-primary saveBtn">Save</button>
                </div>
            </div>
        </div>

        <div class="time-block">
            <div class="row">
                <div class="col-2 hour"> 4pm
                </div>
                <div id="16Div" class="col-8 scheduler" data-value=16>
                    <input id="4pmInput" class="textarea bg-transparent" type="text" placeholder="Add event">
                </div>
                <div class="col-2 save">
                    <button type="button" id="4pmBtn" class="btn btn-primary saveBtn">Save</button>
                </div>
            </div>
        </div>

        <div class="time-block">
            <div class="row">
                <div class="col-2 hour"> 5pm
                </div>
                <div id="17Div" class="col-8 scheduler" data-value=17>
                    <input id="5pmInput" class="textarea bg-transparent" type="text" placeholder="Add event">
                </div>
                <div class="col-2 save">
                    <button type="button" id="5pmBtn" class="btn btn-primary saveBtn">Save</button>
                </div>
            </div>
        </div>

    </div>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <script type="text/javascript">
        //GIVEN I am using a daily planner to create a schedule
        //WHEN I open the planner
        //THEN the current day is displayed at the top of the calendar
        //help from https://www.w3resource.com/javascript-exercises/javascript-basic-exercise-1.php
        var today = new Date();
        var date = today.getDate() + " . " + (today.getMonth() + 1) + " . " + today.getFullYear();
        $("#currentDay").text(date);

        //WHEN I scroll down
        //THEN I am presented with timeblocks for standard business hours

        //WHEN I view the timeblocks for that day
        //THEN each timeblock is color coded to indicate whether it is in the past, present, or future
        //help from https://tecadmin.net/get-current-date-time-javascript/
        var time = today.getHours();
        console.log("current time: " + time);

        const schedulerArr = $('.scheduler').toArray();
        for (let i = 0; i < schedulerArr.length; i++) {
            const currentRowId = "#" + schedulerArr[i].id;
            var timeBlock = $(currentRowId).data().value;
            console.log(timeBlock);
            if (time > timeBlock) {
                $(currentRowId).addClass('past');
            }
            // delete past, present, future; add them back in for loop
            else if (time < timeBlock) {
                $(currentRowId).addClass('future');
            }
            else {
                $(currentRowId).addClass('present');
            }



        }


        //WHEN I click into a timeblock
        //THEN I can enter an event

        //WHEN I click the save button for that timeblock
        //THEN the text for that event is saved in local storage
        //WHEN I refresh the pages
        //THEN the saved events persist
        $(".saveBtn").on("click", function (event) {
            event.preventDefault();
            let buttonId = $(this).attr('id');
            console.log('id of save btn: ' + $(this).attr('id'));
            let time = buttonId.slice(0, 4);
            console.log(time.charAt(3));
            if (time.charAt(3) === "B") {
                time = time.slice(0, -1);
            }
            console.log('new time' + time);
            const inputId = "#" + time + "Input";

            console.log(inputId);
            
            //for (let index = 0; index < schedulerArr.length; index++) {
                //const input = schedulerArr[index].children[0].value;
                //if (input == " "){
                    //continue;
                //}else{
                    //window.localStorage.setItem(schedulerArr[index].id, input);
                    //$(inputId).text(window.localStorage.getItem(input));
                //}
                
            //}
        
            var textEl = $(".textarea");
            var input = localStorage.getItem(inputId);

           // textEl.textContent = input;
            localStorage.setItem(inputId, textEl.val());
            $(".textarea").text(inputId);
            console.log(textEl.val());


        });
    </script>

</body>

</html>